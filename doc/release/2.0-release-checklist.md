# 2.0 发版前 Checklist（对内）

目标：把 2.0（Outliner + `blp-view` + Inline Edit + Block Links）稳定发出去，避免“发了才发现文档/版本/产物/跳转/兼容性不对”。

> 说明：这是 checklist，不是改功能的计划；以代码与实际产物为准。
> 最近更新：2026-02-15

## 1) 对外文档与文案（复核）

- [x] README / docs 里不再出现 1.x 已下线能力的“推荐用法”（历史 Changelog 保留即可）
- [x] `docs/api.md` / `docs/en/api.md` / `docs/zh-TW/api.md`：无 TODO 占位；`plugin.api` 说明与 `src/main.ts` 一致
- [x] `docs/reference/commands.md`（三语）：Outliner 命令 ID 与默认快捷键描述正确
- [x] `docs/reference/settings.md`（三语）：settings key 与默认值与 `src/types/index.ts` 一致
- [x] `docs/reference/yaml.md`（三语）：只写 `blp-view`，不再写 `blp-timeline`
- [x] `docs/usage/outliner.md`（三语）：说明“强 opt-in + 可能写回/规范化”的风险提示清晰
- [x] `docs/changelog.md`（三语）：2.0 置顶内容准确；不要把“未发布/开发中”写给用户（如需可留空的 Unreleased 标题也 OK）
- [x] 站内链接 & 语言切换可用（mkdocs + i18n）

## 2) 域名与跳转（复核）

- [x] 全仓文档站域名统一为 `block-link-plus.jasper1024.com`
  - `CNAME`
  - `mkdocs.yml` 的 `site_url`
  - `src/features/whats-new/getChangelogUrl()` 的跳转
  - README 中的文档链接

## 3) 许可证与第三方声明（复核）

- [x] GPLv3：`LICENSE` / `package.json#license` / README 文案一致
- [x] `THIRD_PARTY_NOTICES.md`：引用的路径存在且确实在用
- [x] `third_party/licenses/*`：第三方 license 文本齐全

## 4) 版本与元数据一致性（必须）

- [x] `manifest.json#version`、`package.json#version`、`versions.json` 三处一致
- [x] `manifest.json#minAppVersion` 确认无误
- [x] `manifest.json#description` 与当前主线能力一致（Outliner + `blp-view` + Inline Edit + Block Links）

## 5) 构建/测试（必须）

- [x] `npm run build-with-types` 通过（TypeScript + esbuild 生产构建）
- [x] `npm test` 全绿
- [x] Release 产物检查（CI / 本地）：
  - `main.js`
  - `styles.css`
  - `manifest.json`
  - `data.json`（没有就用空 `{}` 也行；以 release workflow 为准）

## 6) 升级体验（必须手测）

- [ ] 从 1.x 升级到 2.0：旧 settings key 清理/迁移符合预期（`src/main.ts` 的 legacyKeys 逻辑）
- [ ] What’s New：2.0 升级用户能看到 2.0 内容；按钮跳转到站点 changelog 正确
- [ ] Dataview 未安装/未启用时：
  - `blp-view` 有明确提示/降级
  - 文档中也写清楚依赖

## 7) 手工 Smoke Test（建议录屏/留结果）

- [ ] Block Links：复制 block link / embed / uri（右键菜单 + 命令面板）
- [ ] Multi-line：`^id-id` 范围块生成与嵌入渲染
- [ ] Inline Edit：`![[file#^id]]` / `![[file#Heading]]`（按设置开关验证）
- [ ] Outliner：
  - 启用范围（文件夹/文件 + frontmatter 覆盖）生效
  - Outliner/Markdown 互相切换（pane menu）
  - Zoom / DnD / task toggle / task marker 命令
  - 阅读模式系统尾行隐藏（`fileOutlinerHideSystemLine`）
- [ ] `blp-view`：
  - 基本查询 + group/sort/render（至少覆盖 `embed-list` / `table`）
  - 护栏：source 指向未启用文件时应报错（非 silent）

## 8) OpenSpec 与对内资料（建议）

- [x] `openspec/changes/` 无未归档 change（目前应只有 `archive/`）
- [x] 如有需要：跑一次 `openspec validate --strict`（CI 前先挡掉格式问题）
- [x] 对内文档（`doc/**`、`memory-bank/**`）把“已废弃能力”（timeline/time section/vendored vslinko）标注为历史，避免误导后续开发

## 9) 发布动作（执行清单）

- [ ] 合并：`2.0-outliner` → `master`（处理冲突）
- [ ] 打 tag：`2.0.0`
- [ ] 观察 GitHub Actions：
  - docs 部署（gh-pages）
  - release 构建与附件文件齐全（`.github/workflows/release.yml`）
- [ ] 站点上线后复查：changelog、install、outliner、yaml、settings、commands 页面无 404
